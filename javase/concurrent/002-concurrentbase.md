# 1 线程安全

​		当多个线程访问某个类时，不管运行时环境采用何种调度方式或者这些线程将如何交替执行，并且在主调代码中不需要任何额外的同步或协同，这个类都能表现出正确的行为，那么就称为这个类是线程安全的。

​		线程安全的问题主要针对的就是共享变量，即线程安全问题可以理解为当多个线程同时读写一个共享变量并且没有任何同步措施时，导致出现脏数据或者其他不可见的结果。所以，无状态对象（即无共享变量）一定是线程安全的。

## 1.1 共享变量内存模型

​		Java内存模型规定，将所有的变量都存放在主内存中，当线程使用变量时，会把主内存里面的变量复制到自己的工作空间或者叫工作内存，线程读写变量时操作的是自己工作内存中的变量，处理完成后将变量值更新到主内存。

​		多个线程同时处理共享变量时，由于都是各自在各自的工作空间中处理数据。这样就可能导致线程A对于变量的更新值，对于线程B是不可见。从而引发共享变量值的错误。

​		解决内存不可见的方法：有锁，volatile等，下面会挨个讲解到。